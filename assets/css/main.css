/* =========================================== */
/* 移动端响应式修复 - 新增部分 */
/* =========================================== */

/* 1. 修复所有页面的滚动问题 */
body {
    overflow-x: hidden !important;
    overflow-y: auto !important;
    width: 100% !important;
    height: auto !important;
    min-height: 100vh !important;
}

/* 移除特定页面的滚动限制 */
body.page0 .page-container,
body.page1 .page-container {
    justify-content: flex-start !important;
    height: auto !important;
    min-height: 100vh !important;
    overflow-y: auto !important;
    padding-top: 20px;
    padding-bottom: 100px; /* 给底部导航留出空间 */
}

/* 2. 修复背景SVG显示 */
.background-svg {
    position: fixed !important;
    top: 0;
    left: 0;
    width: 100vw !important;
    height: 100vh !important;
    z-index: -1;
}

.background-svg svg {
    width: 100% !important;
    height: 100% !important;
    min-height: 100vh;
    object-fit: cover;
}

/* 3. 修复内容区域 */
.content-area {
    position: relative !important;
    z-index: 10;
    width: 100% !important;
    max-width: 100% !important;
    min-height: calc(100vh - 150px);
    padding: 20px 15px !important;
    margin: 0 auto;
}

/* 4. 封面页(index.html)特定修复 */
.cover-content {
    padding: 40px 20px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    min-height: 100vh;
    box-sizing: border-box;
}

/* 5. page1.html 特定修复 */
.centered-layout {
    width: 100%;
    padding: 20px 0;
    box-sizing: border-box;
}

.center-content {
    width: 100%;
    max-width: 100%;
}

/* 6. 移动端导航系统修复 */
.nav-controls {
    position: fixed !important;
    bottom: 20px !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    width: 90% !important;
    max-width: 400px !important;
    z-index: 1000 !important;
    background: rgba(0, 0, 0, 0.9) !important;
    backdrop-filter: blur(10px) !important;
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
}

/* 7. 手机端专用媒体查询 */
@media screen and (max-width: 768px) {
    /* 基础调整 */
    html, body {
        width: 100% !important;
        overflow-x: hidden !important;
        position: relative !important;
    }
    
    /* 页面标题调整 */
    .page-header .page-title {
        font-size: 24px !important;
        line-height: 1.3 !important;
    }
    
    .page-number {
        font-size: 20px !important;
    }
    
    /* 封面页调整 */
    .cover-header .main-title {
        font-size: 32px !important;
        line-height: 1.3 !important;
        margin-bottom: 15px !important;
    }
    
    .cover-header .subtitle {
        font-size: 22px !important;
        line-height: 1.4 !important;
        margin-bottom: 20px !important;
    }
    
    .cover-description .description-text {
        font-size: 16px !important;
        line-height: 1.6 !important;
        margin-bottom: 30px !important;
    }
    
    /* page1.html 内容调整 */
    .story-text.large-text {
        font-size: 16px !important;
        line-height: 1.6 !important;
        padding: 0 10px;
    }
    
    .points-grid-2x2 {
        grid-template-columns: 1fr !important;
        gap: 15px !important;
    }
    
    .point-item {
        padding: 15px !important;
    }
    
    /* 问题卡片调整 */
    .question-card {
        padding: 20px 15px !important;
        margin: 0 auto;
    }
    
    .choices-container {
        grid-template-columns: 1fr !important;
        gap: 12px !important;
    }
    
    .choice-btn {
        padding: 15px !important;
        min-height: 70px !important;
    }
    
    .choice-letter {
        width: 35px !important;
        height: 35px !important;
        font-size: 16px !important;
    }
    
    /* 修复字体显示 */
    * {
        -webkit-text-size-adjust: 100%;
        text-size-adjust: 100%;
    }
    
    /* 确保所有内容可点击 */
    button, 
    .choice-btn, 
    .nav-btn {
        min-height: 44px !important; /* iOS最小触摸目标 */
    }
    
    /* 修复封面页背景显示问题 */
    body.page0 {
        background: linear-gradient(180deg, 
            #1a237e 0%, 
            #2c387e 10%,
            #3949ab 25%,
            #5c6bc0 50%,
            #9575cd 75%,
            #ffb74d 100%
        ) !important;
    }
    
    body.page0 .background-svg {
        position: fixed !important;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        width: 100vw !important;
        height: 100vh !important;
        z-index: -1;
    }
    
    /* page2背景过渡修复 */
    body.page2 {
        background: linear-gradient(180deg, 
            #0a1c5a 0%, 
            #0d47a1 10%, 
            #1976d2 30%, 
            #42a5f5 70%, 
            #64b5f6 100%
        ) !important;
    }
    
    /* page1背景过渡修复 */
    body.page1 {
        background: linear-gradient(180deg,
            #000814 0%,
            #001d3d 20%,
            #003566 40%,
            #0077b6 70%,
            #00b4d8 100%
        ) !important;
    }
    
    /* 为SVG背景添加渐变遮罩，实现平滑过渡 */
    .background-svg::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
            to bottom,
            rgba(26, 35, 126, 0.3) 0%,
            rgba(26, 35, 126, 0.1) 20%,
            transparent 50%,
            transparent 80%,
            rgba(26, 35, 126, 0.1) 100%
        );
        z-index: 1;
        pointer-events: none;
    }
    
    /* page2特定遮罩 */
    body.page2 .background-svg::before {
        background: linear-gradient(
            to bottom,
            rgba(13, 71, 161, 0.4) 0%,
            rgba(13, 71, 161, 0.2) 10%,
            transparent 30%,
            transparent 80%,
            rgba(13, 71, 161, 0.2) 100%
        );
    }
    
    /* 封面页特定遮罩 */
    body.page0 .background-svg::before {
        background: linear-gradient(
            to bottom,
            rgba(26, 35, 126, 0.4) 0%,
            rgba(57, 73, 171, 0.2) 20%,
            transparent 50%,
            transparent 80%,
            rgba(255, 183, 77, 0.2) 100%
        );
    }
    
    /* page1特定遮罩 */
    body.page1 .background-svg::before {
        background: linear-gradient(
            to bottom,
            rgba(0, 8, 20, 0.5) 0%,
            rgba(0, 29, 61, 0.3) 20%,
            transparent 50%,
            transparent 80%,
            rgba(0, 180, 216, 0.2) 100%
        );
    }
}

/* 8. 平板设备适配 */
@media screen and (min-width: 769px) and (max-width: 1024px) {
    .content-area {
        width: 95% !important;
        max-width: 800px !important;
    }
    
    .choices-container {
        grid-template-columns: 1fr 1fr !important;
    }
}

/* 9. 修复iOS Safari 100vh问题 */
@supports (-webkit-touch-callout: none) {
    .page-container,
    .background-svg {
        height: -webkit-fill-available !important;
        min-height: -webkit-fill-available !important;
    }
    
    .cover-content {
        min-height: -webkit-fill-available;
    }
}

/* 10. 触摸设备优化 */
@media (hover: none) and (pointer: coarse) {
    /* 移除桌面端的hover效果 */
    .choice-btn:hover,
    .nav-btn:hover {
        transform: none !important;
    }
    
    /* 添加触摸反馈 */
    .choice-btn:active,
    .nav-btn:active {
        transform: scale(0.98) !important;
        opacity: 0.8 !important;
    }
}

/* 11. 确保页面加载时正确显示 */
.page-container {
    display: block !important;
    width: 100% !important;
    min-height: 100vh !important;
}

/* 12. 通用背景过渡优化 */
.background-svg svg {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: opacity 0.5s ease;
}

/* 13. 确保页面加载时背景正确显示 */
.page-container {
    position: relative;
    overflow: hidden;
}

/* 14. 为所有页面添加边缘渐变过渡 */
.page-container::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 30px;
    background: linear-gradient(to bottom, 
        rgba(0, 0, 0, 0.4) 0%, 
        transparent 100%);
    z-index: 5;
    pointer-events: none;
}

.page-container::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 30px;
    background: linear-gradient(to top, 
        rgba(0, 0, 0, 0.4) 0%, 
        transparent 100%);
    z-index: 5;
    pointer-events: none;
}

/* 15. 确保JavaScript生成的导航系统正确显示 */
.navigation {
    position: fixed !important;
    bottom: 30px !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    z-index: 1000 !important;
    display: flex !important;
    opacity: 1 !important;
    visibility: visible !important;
}

/* 16. 隐藏所有内嵌的导航系统 */
.navigation-system {
    display: none !important;
}
